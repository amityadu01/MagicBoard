<html>
  <head>
    <title>Magic Board</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="css/bootstrap.css">
        
        <!-- Optional theme -->
        <link rel="stylesheet" href="css/bootstrap-theme.css">
            
            <!-- magic board css -->
            <link rel="stylesheet" href="css/magicboard.css">
   <style>
       .navbar-custom {
           background-color:#229922;
           color:#ffffff;
           border-radius:0;
       }
   
   .navbar-custom .navbar-nav > li > a {
       color:#fff;
   }
   .navbar-custom .navbar-nav > .active > a, .navbar-nav > .active > a:hover, .navbar-nav > .active > a:focus {
       color: #ffffff;
       background-color:transparent;
   }
   .navbar-custom .navbar-brand {
       color:#eeeeee;
   }
   
   .vertBox {
       height:800px;
   }
   
   .imgIcon {
       float:left;height:35px;
   }
   </style>
   <script src="js/MagicBoard.min.js" ></script>
   <!--
   <script src="js/base.js" ></script>
   <script src="js/event.js" ></script>
   <script src="js/utility.js" ></script>
   <script src="js/logger.js" ></script>
   -->
   <script>
       
       
   function allowDrop(ev) {
           ev.preventDefault();
    }
   
   function drag(ev) {
       ev.dataTransfer.setData("text", ev.target.id);
   }
   
   function drop(ev) {
       ev.preventDefault();
       var dt = ev.dataTransfer;
       var data = ev.dataTransfer.getData("text");
       var files = dt.files; var fLen = files.length;
       
       if (fLen)
       {  // this means external files are dragged
           //tempDraw();
           for (var i = 0; i < files.length; i++) {
               var file = files[i];
               var fileType = file.type;
               var fileName = file.name;
               var reader = new FileReader();
               
               reader.onload = function(e) {
                   var jsonString = reader.result;
                   var obj = JSON.parse(jsonString);
                   var sheet1 = new Sheet(obj);
                   MagicBoard.sheetBook.addSheet(sheet1);
                   MagicBoard.sheetBook.setCurrentSheet(sheet1);
                   Utility.Sheet.connectIds();
               }
               
               reader.readAsText(file);
           }
       } else
       {
           var pos = MagicBoard.getPos(ev);
           pos.x = Math.round(pos.x); pos.y = Math.round(pos.y);
           addObject(data,false,pos,true);
       }


       //ev.target.appendChild(document.getElementById(data));
   }
   
   function downloadSheetImage()
   {
       var sheet = MagicBoard.sheetBook.currentSheet;
       var dataURL = sheet.getImage();
       dataURL = dataURL.replace("data:image/png","data:application/octet-stream");
       var a = document.createElement("a");
       a.setAttribute("download",sheet.name+".png");
       a.href = dataURL;
       a.click();
       
   }
       
    function addObject(id,noDraw,pos,cnter)
    {
        var shapeDetail = customShapes[id];
        var s = new Shape(shapeDetail);
        if (!noDraw)
        {
            s.draw();
            s.addHover();
            if (pos) {
                if (cnter)
                {
                    var x = pos.x -  s.dimension.width /2;
                    var y = pos.y - s.dimension.height /2;
                    s.setPosition({x:x,y:y},true);
                    
                } else s.setPosition(pos,true); // setposition with align option
            } else
            {
                var sheet = MagicBoard.sheetBook.currentSheet;
                var margin = 15;
                var potentialGridSeqs = Utility.Sheet.isGridAvailable(-1,sheet,s);
                if (potentialGridSeqs.length > 0)
                {
                    var grid = sheet.courseGrids[potentialGridSeqs[0]];
                        s.setPosition({"x":(grid.x1 + margin),"y":(grid.y1+margin)});
                } else  s.setPosition({"x":120,"y":120});

            }
        }

        return s;
    }
   
   /*
    // sample
    var r = new ShapeComponent({type:"rect",dimension:{width:100,height:100,x:0,y:0},param:{"fill":"none","stroke-width":1,"stroke":"black"}});
    var c = new ShapeComponent({type:"circle",dimension:{cx:50,cy:50,r:50},param:{"fill":"none","stroke-width":1,"stroke":"black"}});
    var o = new ShapeComponent({type:"ellipse",dimension:{cx:50,cy:50,rx:40,ry:20},param:{"fill":"none","stroke-width":1,"stroke":"black"}});
    var p = new ShapeComponent({type:"path",dimension:{d:[{op:"m",x:0,y:40},{op:"l",x:30,y:40},{op:"m",x:10,y:40},{op:"l",x:30,y:40}]},param:{"fill":"none","stroke-width":1,"stroke":"black"}});
    var t = new ShapeComponent({type:"text",dimension:{width:100,height:10,x:20,cy:50},param:{"font-size":14},"innerHTML":"Object"});
    var i = {type:"image",dimension:{width:10,height:10,cx:70,cy:50},param:{"src":"image/uml1.png"}};
    var s =
    {
    frame:{width:100,height:100,left:130,top:140,unit:"px"},
    param:{alignmentRails:true,"background-color":"lightblue","border-width":1,"border-color":"black"},
    components:[r,c,o,t,p]
    }
    */
   var uml11 = {type:"rect",dimension:{width:100,height:100,x:0,y:0},param:{"fill":"rgb(27,141,17)","stroke-width":1,"stroke":"rgb(27,141,17)","border-radius":8}};
   var txt = {type:"text",dimension:{width:100,height:10,x:30,y:56},param:{"font-size":14,fill:"black"},"innerHTML":"Text"};
   var obj = {type:"text",dimension:{width:100,height:10,x:30,y:60},param:{"font-size":14,fill:"white"},"innerHTML":"Object"};
   var obj1 = {type:"text",dimension:{width:100,height:10,x:30,y:8},param:{"font-size":14,fill:"white"},"innerHTML":":Object"};
   var usecase = {type:"text",dimension:{width:100,height:10,x:28,y:56},param:{"font-size":14,fill:"white"},"innerHTML":"Use Case"};
   var proc = {type:"text",dimension:{width:100,height:10,x:34,y:60},param:{"font-size":14,"fill":"white"},"innerHTML":"Process"};
   var actor = {type:"text",dimension:{width:100,height:100,x:4,y:90},param:{"font-size":14,"fill":"rgb(27,141,17)"},"innerHTML":"Actor"};
   var hRail = {type:"rect",dimension:{width:100,height:100,x:0,y:0},param:{"fill":"none","stroke-width":1,"stroke":"rgb(27,141,17)","border-radius":8}};
   //
   var uml120 = {"type":"ellipse","origDim":{"cx":13,"cy":7,"rx":7.5,"ry":7.5},"dimension":{"cx":47,"cy":11.864406779661017,"rx":25,"ry":12.711864406779661},"param":{"fill":"rgb(27,141,17)","stroke":"rgb(27,141,17)","pointer-events":"all"}}

   var uml121 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":50,"y":23.728813559322035},{"op":"L","x":50,"y":66.10169491525424},{"op":"M","x":50,"y":39.20338983050848},{"op":"L","x":0,"y":39.20338983050848},{"op":"M","x":50,"y":39.20338983050848},{"op":"L","x":100,"y":39.20338983050848},{"op":"M","x":50,"y":66.10169491525424},{"op":"L","x":0,"y":100},{"op":"M","x":50,"y":66.10169491525424},{"op":"L","x":100,"y":100}]},"param":{"fill":"none","stroke":"rgb(27,141,17)","stroke-miterlimit":"10","stroke-width":2},"lines":[{"op":"M","x":15,"y":14},{"op":"L","x":15,"y":39},{"op":"M","x":15,"y":19},{"op":"L","x":0,"y":19},{"op":"M","x":15,"y":19},{"op":"L","x":30,"y":19},{"op":"M","x":15,"y":39},{"op":"L","x":0,"y":59},{"op":"M","x":15,"y":39},{"op":"L","x":30,"y":59}]}
   var uml130 = {"type":"ellipse","origDim":{"cx":70,"cy":35,"rx":70,"ry":35},"dimension":{"cx":50,"cy":50,"rx":50,"ry":50},"param":{"fill":"rgb(27,141,17)","stroke":"rgb(27,141,17)","pointer-events":"all","stroke-width":1}}
   // flow
   var flowData = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":16.666666666666668,"y":8.474576271186441},{"op":"L","x":100,"y":0},{"op":"L","x":84.44444444444444,"y":91.52542372881356},{"op":"L","x":0,"y":100},{"op":"Z"}]},"param":{"fill":"rgb(27,141,17)","stroke":"rgb(27,141,17)","stroke-width":"2","stroke-miterlimit":"10","pointer-events":"all"},"lines":[{"op":"M","x":15,"y":5},{"op":"L","x":90,"y":0},{"op":"L","x":76,"y":54},{"op":"L","x":0,"y":59},{"op":"Z"}]};
   
   var flowDB1 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":0,"y":83.33333333333333},{"op":"L","x":0,"y":16.666666666666668},{"op":"C","x1":0,"y1":6.666666666666667,"x2":21.666666666666668,"y2":0,"x":50,"y":0},{"op":"C","x1":76.66666666666667,"y1":0,"x2":100,"y2":6.666666666666667,"x":100,"y":16.666666666666668},{"op":"L","x":100,"y":83.33333333333333},{"op":"C","x1":100,"y1":91.66666666666667,"x2":76.66666666666667,"y2":100,"x":50,"y":100},{"op":"C","x1":21.666666666666668,"y1":100,"x2":0,"y2":91.66666666666667,"x":0,"y":83.33333333333333},{"op":"Z"}]},"param":{"fill":"rgb(27,141,17)","stroke":"#FFFFFF","stroke-width":"2","stroke-miterlimit":"10","pointer-events":"all"},"lines":[{"op":"M","x":0,"y":50},{"op":"L","x":0,"y":10},{"op":"C","x1":0,"y1":4,"x2":13,"y2":0,"x":30,"y":0},{"op":"C","x1":46,"y1":0,"x2":60,"y2":4,"x":60,"y":10},{"op":"L","x":60,"y":50},{"op":"C","x1":60,"y1":55,"x2":46,"y2":60,"x":30,"y":60},{"op":"C","x1":13,"y1":60,"x2":0,"y2":55,"x":0,"y":50},{"op":"Z"}]}
   var flowDB2 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":0,"y":16.666666666666668},{"op":"C","x1":0,"y1":25,"x2":21.666666666666668,"y2":33.333333333333336,"x":50,"y":33.333333333333336},{"op":"C","x1":76.66666666666667,"y1":33.333333333333336,"x2":100,"y2":25,"x":100,"y":16.666666666666668}]},"param":{"fill":"none","stroke":"#FFFFFF","stroke-width":"2","stroke-miterlimit":"10"},"lines":[{"op":"M","x":0,"y":10},{"op":"C","x1":0,"y1":15,"x2":13,"y2":20,"x":30,"y":20},{"op":"C","x1":46,"y1":20,"x2":60,"y2":15,"x":60,"y":10}]};
   var flowDecision1 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":50,"y":0},{"op":"L","x":100,"y":50},{"op":"L","x":50,"y":100},{"op":"L","x":0,"y":50},{"op":"Z"}]},"param":{"fill":"rgb(27,141,17)","stroke":"rgb(27,141,17)","stroke-width":"2","stroke-miterlimit":"10","pointer-events":"all"},"lines":[{"op":"M","x":50,"y":0},{"op":"L","x":100,"y":50},{"op":"L","x":50,"y":100},{"op":"L","x":0,"y":50},{"op":"Z"}]};
   

var flowDoc1 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":0,"y":5.555555555555555},{"op":"C","x1":0,"y1":2.7777777777777777,"x2":2.0408163265306123,"y2":0,"x":5.1020408163265305,"y":0},{"op":"L","x":93.87755102040816,"y":0},{"op":"C","x1":96.93877551020408,"y1":0,"x2":100,"y2":2.7777777777777777,"x":100,"y":5.555555555555555},{"op":"L","x":100,"y":72.22222222222223},{"op":"C","x1":82.65306122448979,"y1":51.388888888888886,"x2":66.3265306122449,"y2":37.5,"x":50,"y":72.22222222222223},{"op":"C","x1":32.6530612244898,"y1":100,"x2":16.3265306122449,"y2":80.55555555555556,"x":0,"y":62.5},{"op":"Z"}]},"param":{"fill":"rgb(27,141,17)","stroke":"rgb(27,144,17)","stroke-width":"2","stroke-miterlimit":"10","pointer-events":"all"},"lines":[{"op":"M","x":0,"y":4},{"op":"C","x1":0,"y1":2,"x2":2,"y2":0,"x":5,"y":0},{"op":"L","x":92,"y":0},{"op":"C","x1":95,"y1":0,"x2":98,"y2":2,"x":98,"y":4},{"op":"L","x":98,"y":52},{"op":"C","x1":81,"y1":37,"x2":65,"y2":27,"x":49,"y":52},{"op":"C","x1":32,"y1":72,"x2":16,"y2":58,"x":0,"y":45},{"op":"Z"}]};

var flowManual1 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":0,"y":41.666666666666664},{"op":"L","x":94,"y":0},{"op":"C","x1":96,"y1":0,"x2":97,"y2":0,"x":98,"y":1.6666666666666667},{"op":"C","x1":99,"y1":3.3333333333333335,"x2":99,"y2":5,"x":99,"y":8.333333333333334},{"op":"L","x":99,"y":91.66666666666667},{"op":"C","x1":100,"y1":95,"x2":98,"y2":98.33333333333333,"x":95,"y":100},{"op":"L","x":5,"y":100},{"op":"C","x1":3,"y1":100,"x2":2,"y2":98.33333333333333,"x":1,"y":96.66666666666667},{"op":"C","x1":0,"y1":95,"x2":0,"y2":93.33333333333333,"x":0,"y":91.66666666666667},{"op":"L","x":0,"y":41.666666666666664},{"op":"Z"}]},"param":{"fill":"rgb(27,141,17)","stroke":"rgb(27,141,17)","stroke-width":"2","stroke-miterlimit":"10","pointer-events":"all"}};

var flowIstorage0 = {"type":"rect","origDim":{"x":0,"y":0,"width":70,"height":70,"rx":5,"ry":5},"dimension":{"x":0,"y":0,"width":100,"height":100,"rx":7.142857142857143,"ry":7.142857142857143},"param":{"fill":"rgb(27,141,17)","stroke":"rgb(27,141,17)","stroke-width":"2","pointer-events":"all"},"lines":[]};
var flowIstorage1 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":0,"y":21.428571428571427},{"op":"L","x":100,"y":21.428571428571427}]},"param":{"fill":"none","stroke":"white","stroke-width":"2","stroke-miterlimit":"10"},"lines":[{"op":"M","x":0,"y":15},{"op":"L","x":70,"y":15}]};
var flowIstorage2 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":21.428571428571427,"y":0},{"op":"L","x":21.428571428571427,"y":100}]},"param":{"fill":"none","stroke":"white","stroke-width":"2","stroke-miterlimit":"10"},"lines":[{"op":"M","x":15,"y":0},{"op":"L","x":15,"y":70}]}

var flowSeqData0  = {"type":"ellipse","origDim":{"cx":50,"cy":50,"rx":50,"ry":50},"dimension":{"cx":50,"cy":50,"rx":50,"ry":50},"param":{"fill":"rgb(27,141,17)","stroke":"rgb(27,141,17)","stroke-width":"2","pointer-events":"all"},"lines":[]};
var flowSeqData1 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":50,"y":100},{"op":"L","x":100,"y":100}]},"param":{"fill":"none","stroke":"rgb(27,141,17)","stroke-width":"2","stroke-miterlimit":"10"},"lines":[{"op":"M","x":50,"y":100},{"op":"L","x":100,"y":100}]};
var flowPreDef0 = {"type":"rect","origDim":{"x":0,"y":0,"width":100,"height":60,"rx":4.03,"ry":4.03},"dimension":{"x":0,"y":0,"width":100,"height":100,"rx":4.03,"ry":6.716666666666667},"param":{"fill":"rgb(27,141,17)","stroke":"rgb(27,141,17)","stroke-width":"1","pointer-events":"all"},"lines":[]};
var flowPreDef1 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":14,"y":0},{"op":"L","x":14,"y":100}]},"param":{"fill":"none","stroke":"white","stroke-width":"2","stroke-miterlimit":"10"},"lines":[{"op":"M","x":14,"y":0},{"op":"L","x":14,"y":60}]};
var flowPreDef2 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":85,"y":0},{"op":"L","x":85,"y":100}]},"param":{"fill":"none","stroke":"white","stroke-width":"2","stroke-miterlimit":"10"},"lines":[{"op":"M","x":85,"y":0},{"op":"L","x":85,"y":60}]}

var flowStored0 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":10,"y":0},{"op":"L","x":99,"y":0},{"op":"C","x1":100,"y1":0,"x2":100,"y2":1.6666666666666667,"x":99,"y":3.3333333333333335},{"op":"C","x1":95,"y1":10,"x2":92,"y2":28.333333333333332,"x":92,"y":50},{"op":"C","x1":92,"y1":70,"x2":95,"y2":88.33333333333333,"x":99,"y":96.66666666666667},{"op":"C","x1":100,"y1":96.66666666666667,"x2":100,"y2":98.33333333333333,"x":99,"y":100},{"op":"L","x":10,"y":100},{"op":"C","x1":4,"y1":100,"x2":0,"y2":76.66666666666667,"x":0,"y":50},{"op":"C","x1":0,"y1":21.666666666666668,"x2":4,"y2":0,"x":10,"y":0},{"op":"Z"}]},"param":{"fill":"rgb(27,141,17)","stroke":"rgb(27,141,17)","stroke-width":"2","stroke-miterlimit":"10","pointer-events":"all"},"lines":[{"op":"M","x":10,"y":0},{"op":"L","x":99,"y":0},{"op":"C","x1":100,"y1":0,"x2":100,"y2":1,"x":99,"y":2},{"op":"C","x1":95,"y1":6,"x2":92,"y2":17,"x":92,"y":30},{"op":"C","x1":92,"y1":42,"x2":95,"y2":53,"x":99,"y":58},{"op":"C","x1":100,"y1":58,"x2":100,"y2":59,"x":99,"y":60},{"op":"L","x":10,"y":60},{"op":"C","x1":4,"y1":60,"x2":0,"y2":46,"x":0,"y":30},{"op":"C","x1":0,"y1":13,"x2":4,"y2":0,"x":10,"y":0},{"op":"Z"}]}

var flowStart0 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":30,"y":0},{"op":"L","x":69,"y":0},{"op":"C","x1":86,"y1":0,"x2":100,"y2":21.666666666666668,"x":100,"y":50},{"op":"C","x1":100,"y1":76.66666666666667,"x2":86,"y2":100,"x":69,"y":100},{"op":"L","x":30,"y":100},{"op":"C","x1":13,"y1":100,"x2":0,"y2":76.66666666666667,"x":0,"y":50},{"op":"C","x1":0,"y1":21.666666666666668,"x2":13,"y2":0,"x":30,"y":0},{"op":"Z"}]},"param":{"fill":"rgb(27,141,17)","stroke":"rgb(27,141,17)","stroke-width":"2","stroke-miterlimit":"10","pointer-events":"all"},"lines":[{"op":"M","x":30,"y":0},{"op":"L","x":69,"y":0},{"op":"C","x1":86,"y1":0,"x2":100,"y2":13,"x":100,"y":30},{"op":"C","x1":100,"y1":46,"x2":86,"y2":60,"x":69,"y":60},{"op":"L","x":30,"y":60},{"op":"C","x1":13,"y1":60,"x2":0,"y2":46,"x":0,"y":30},{"op":"C","x1":0,"y1":13,"x2":13,"y2":0,"x":30,"y":0},{"op":"Z"}]}


var laneV1 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":0,"y":4.55531453362256},{"op":"L","x":0,"y":0.21691973969631237},{"op":"L","x":89.55223880597015,"y":0.21691973969631237},{"op":"L","x":89.55223880597015,"y":4.55531453362256},{"op":"Z"}]},"param":{"fill":"rgb(27,141,17)","stroke":"rgb(27,141,17)","stroke-miterlimit":"10","pointer-events":"all"},"lines":[{"op":"M","x":0,"y":21},{"op":"L","x":0,"y":1},{"op":"L","x":120,"y":1},{"op":"L","x":120,"y":21},{"op":"Z"}]}

var laneV2 = {"type":"text","origDim":{"x":34,"y":18},"dimension":{"x":27.419354838709676,"y":3.9045553145336225},"param":{"fill":"white"},"lines":[],innerHTML:"Lane"}

var laneV3 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":100,"y":100},{"op":"L","x":100,"y":0}]},"param":{"fill":"none","stroke":"rgb(27,141,17)","stroke-miterlimit":"10","stroke-width":"2","pointer-events":"none"},"lines":[{"op":"M","x":134,"y":461},{"op":"L","x":134,"y":0}]}
var ie1 = {"type":"image","origDim":{x:0,y:0,width:484,height:456},"dimension":{x:1,y:1,width:100,height:100},"param":{},"xlink":"image/ie.png"}
var server1 = {"type":"image","origDim":{x:0,y:0,width:369,height:512},"dimension":{x:1,y:1,width:100,height:100},"param":{},"xlink":"image/server.png"}
var firewall1 = {"type":"image","origDim":{x:0,y:0,width:370,height:250},"dimension":{x:1,y:1,width:100,height:100},"param":{},"xlink":"image/firewall.png"}

// uml frames
/*
var umlFrame0 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":0,"y":0},{"op":"L","x":20,"y":0},{"op":"L","x":20,"y":7.5},{"op":"L","x":16.666666666666668,"y":15},{"op":"L","x":0,"y":15},{"op":"Z"}]},"param":{"fill":"rgb(27,141,17)","stroke":"rgb(27,141,17)","stroke-miterlimit":"10","pointer-events":"all"},"lines":[{"op":"M","x":0,"y":0},{"op":"L","x":60,"y":0},{"op":"L","x":60,"y":15},{"op":"L","x":50,"y":30},{"op":"L","x":0,"y":30},{"op":"Z"}]}

var umlFrame1 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":20,"y":0},{"op":"L","x":100,"y":0},{"op":"L","x":100,"y":100},{"op":"L","x":0,"y":100},{"op":"L","x":0,"y":15}]},"param":{"fill":"none","stroke":"rgb(27,141,17)","stroke-miterlimit":"10"},"lines":[{"op":"M","x":60,"y":0},{"op":"L","x":300,"y":0},{"op":"L","x":300,"y":200},{"op":"L","x":0,"y":200},{"op":"L","x":0,"y":30}]}

*/
var umlFrame0 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":0,"y":0},{"op":"L","x":20,"y":0},{"op":"L","x":20,"y":7.5},{"op":"L","x":16.666666666666668,"y":15},{"op":"L","x":0,"y":15},{"op":"Z"}]},"param":{"fill":"rgb(27,141,17)","stroke":"rgb(27,141,17)","stroke-miterlimit":"10","stroke-width":"1","pointer-events":"all"},"lines":[{"op":"M","x":0,"y":0},{"op":"L","x":60,"y":0},{"op":"L","x":60,"y":15},{"op":"L","x":50,"y":30},{"op":"L","x":0,"y":30},{"op":"Z"}]}

var umlFrame1 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":20,"y":0},{"op":"L","x":100,"y":0},{"op":"L","x":100,"y":100},{"op":"L","x":0,"y":100},{"op":"L","x":0,"y":15}]},"param":{"fill":"none","stroke":"rgb(27,141,17)","stroke-miterlimit":"10","stroke-width":"1"},"lines":[{"op":"M","x":60,"y":0},{"op":"L","x":300,"y":0},{"op":"L","x":300,"y":200},{"op":"L","x":0,"y":200},{"op":"L","x":0,"y":30}]}
//
var umlLifeLine0 = {"type":"rect","origDim":{"x":0,"y":0,"width":100,"height":40},"dimension":{"x":0,"y":0,"width":100,"height":13.333333333333334},"param":{"fill":"rgb(27,141,17)","stroke":"rgb(27,141,17)","pointer-events":"all"},"lines":[]}

var umlLifeLine1 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":50,"y":13.333333333333334},{"op":"L","x":50,"y":100}]},"param":{"fill":"none","stroke":"rgb(27,141,17)","stroke-miterlimit":"10","stroke-dasharray":"3 3"},"lines":[{"op":"M","x":50,"y":40},{"op":"L","x":50,"y":300}]}

//
var umlActivity0 = {"type":"rect","origDim":{"x":0,"y":0,"width":10,"height":80},"dimension":{"x":0,"y":0,"width":100,"height":100},"param":{"fill":"rgb(27,141,17)","stroke":"rgb(27,141,17)","pointer-events":"all"},"lines":[]}
// UML Class

var umlClass0 = {"type":"rect","origDim":{"x":0,"y":0,"width":160,"height":90},"dimension":{"x":0,"y":0,"width":100,"height":100},"param":{"fill":"rgb(27,141,17)","stroke":"white","pointer-events":"all"},"lines":[]}

var umlClassText = {type:"text",dimension:{width:100,height:10,x:30,y:18},param:{"font-size":12,fill:"white"},"innerHTML":"ClassName"};

var umlClass1 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":0,"y":28.88888888888889},{"op":"L","x":0,"y":0},{"op":"L","x":100,"y":0},{"op":"L","x":100,"y":28.88888888888889},{"op":"Z"}]},"param":{"fill":"rgb(27,141,17)","stroke":"white","stroke-miterlimit":"10","pointer-events":"all"},"lines":[{"op":"M","x":0,"y":26},{"op":"L","x":0,"y":0},{"op":"L","x":160,"y":0},{"op":"L","x":160,"y":26},{"op":"Z"}]}

var umlFieldText = {type:"text",dimension:{width:100,height:10,x:14,y:52},param:{"font-size":12,fill:"white"},"innerHTML":"+field:type"};

var umlClass2 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":0,"y":62.22222222222222},{"op":"L","x":100,"y":62.22222222222222}]},"param":{"fill":"none","stroke":"white","stroke-miterlimit":"10"},"lines":[{"op":"M","x":0,"y":56},{"op":"L","x":160,"y":56}]}

var umlMethodText = {type:"text",dimension:{width:100,height:10,x:14,y:84},param:{"font-size":12,fill:"white"},"innerHTML":"+method(type):type"};

var umlPackage0 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":0,"y":0},{"op":"L","x":57.142857142857146,"y":0},{"op":"L","x":57.142857142857146,"y":28},{"op":"L","x":100,"y":28},{"op":"L","x":100,"y":100},{"op":"L","x":0,"y":100},{"op":"L","x":0,"y":28},{"op":"Z"}]},"param":{"fill":"none","stroke":"rgb(27,141,17)","stroke-width":"2","stroke-miterlimit":"10","pointer-events":"all"},"lines":[{"op":"M","x":0,"y":0},{"op":"L","x":40,"y":0},{"op":"L","x":40,"y":14},{"op":"L","x":70,"y":14},{"op":"L","x":70,"y":50},{"op":"L","x":0,"y":50},{"op":"L","x":0,"y":14},{"op":"Z"}]}

var umlPackage1 = {"type":"path","origDim":{},"dimension":{"d":[{"op":"M","x":0,"y":28},{"op":"L","x":57.142857142857146,"y":28}]},"param":{"fill":"none","stroke":"rgb(27,141,17)","stroke-width":"2","stroke-miterlimit":"10"},"lines":[{"op":"M","x":0,"y":14},{"op":"L","x":40,"y":14}]}




//
   var defaultSheet = "Sheet1";
   var customShapes = {
       "layers":{
           frame:{left:10,width:"80%",height:150,"border":"1px solid","border-radius":"10px",unit:"px"},
           param:{alignmentRails:true},
           componentParms:[hRail]
       },
       "process":{
           frame:{left:100,top:100,width:124,height:84,"border":"1px solid","border-radius":"10px",unit:"px"},
           param:{alignmentRails:true},
           componentParms:[uml11,proc]
       },
       "umlObject":{
           frame:{width:110,height:50,unit:"px"},
           param:{alignmentRails:true},
           componentParms:[uml11,obj]
       },
       /*
       "uml12":{"type":"Custom","style":{left:100,top:100,width:60,height:120},"html":"<circle cx='15' cy='8' r='7.5' fill='rgb(27,141,17)' stroke='rgb(27,141,17)' ></circle><path d='M 15 15 L 15 40 M 15 20 L 0 20 M 15 20 L 30 20 M 15 40 L 0 60 M 15 40 L 30 60' fill='none' stroke='rgb(27,141,17)' stroke-miterlimit='10'></path>","children":["Actor"]},
*/
        "uml12":{"frame":{"width":30,"height":59,"unit":"px"},"param":{"alignmentRails":true},"componentParms":[uml120,uml121]},

        "uml13":{"frame":{"width":145,"height":75,"unit":"px"},"param":{"alignmentRails":true},"componentParms":[uml130,usecase]},
        "poolV":{"type":"Custom","style":{left:100,top:100,width:250,height:"80%","border-left":"1px solid","border-right":"1px solid"},"html":"<div></div>","children":["laneTitle"]},
        "bpm1":{"type":"Custom","style":{left:100,top:100,width:124,height:84},"html":"<rect x=\"2\" y=\"2\" width=\"120\" height=\"80\" rx=\"3\" ry=\"3\" fill=\"rgb(27,141,17)\" stroke=\"rgb(27,141,17)\"></rect>","children":["task"]},
        "bpm2":{"type":"Custom","style":{left:100,top:100,width:124,height:84},"html":"<rect x=\"2\" y=\"2\" width=\"120\" height=\"80\" rx=\"12\" ry=\"12\" fill=\"rgb(27,141,17)\" stroke=\"rgb(27,141,17)\" ></rect><rect x=\"4\" y=\"4\" width=\"116\" height=\"76\" rx=\"11.4\" ry=\"11.4\" fill=\"rgb(27,141,17)\" stroke=\"rgb(27,141,17)\" ></rect>","children":["transaction"]},
        "bpm3":{"type":"Custom","style":{left:100,top:100,width:124,height:84},"html":"<rect x=\"2\" y=\"2\" width=\"120\" height=\"80\" rx=\"12\" ry=\"12\" fill=\"rgb(27,141,17)\" stroke=\"rgb(27,141,17)\" stroke-dashArray=\"1 4\" ></rect>"},
        "bpm4":{"type":"Custom","style":{left:100,top:100,width:120,height:80},"html":"<img width='120' height='80' src='image/bpm4.png' />"},
        "bpm5":{"type":"Custom","style":{left:100,top:100,width:120,height:80},"html":"<img width='120' height='80' src='image/bpm5.png' />"},
        "bpm6":{"type":"Custom","style":{left:100,top:100,width:120,height:80},"html":"<img width='120' height='80' src='image/bpm6.png' />"},
        "bpm7":{"type":"Custom","style":{left:100,top:100,width:120,height:80},"html":"<img width='120' height='80' src='image/bpm7.png' />"},
        "bpm8":{"type":"Custom","style":{left:100,top:100,width:120,height:80},"html":"<img width='120' height='80' src='image/bpm8.png' />"},
        "bpm9":{"type":"Custom","style":{left:100,top:100,width:140,height:80},"html":"<img width='140' height='80' src='image/bpm9.png' />"},
         "bpmg1":{"type":"Custom","style":{left:100,top:100,width:50,height:50},"html":"<img width='50' height='50' src='image/bpmg1.png' />"},
         "bpmg2":{"type":"Custom","style":{left:100,top:100,width:50,height:50},"html":"<img width='50' height='50' src='image/bpmg2.png' />"},
         "bpmg3":{"type":"Custom","style":{left:100,top:100,width:50,height:50},"html":"<img width='50' height='50' src='image/bpmg3.png' />"},
         "bpme1":{"type":"Custom","style":{left:100,top:100,width:50,height:50},"html":"<img width='50' height='50' src='image/bpme1.png' />"},
         "bpme2":{"type":"Custom","style":{left:100,top:100,width:50,height:50},"html":"<img width='50' height='50' src='image/bpme2.png' />"},
         "bpme3":{"type":"Custom","style":{left:100,top:100,width:50,height:50},"html":"<img width='50' height='50' src='image/bpme3.png' />"},
         "bpme4":{"type":"Custom","style":{left:100,top:100,width:50,height:50},"html":"<img width='50' height='50' src='image/bpme4.png' />"},
          "processTitle":{"type":"Text","style":{left:0,top:"37%",width:"100%",height:30},"html":"<div >Process</div>","options":{"root":"center","alignmentRails":false}},
          "task":{"type":"Text","style":{left:0,top:"37%",width:"100%",height:30},"html":"<div >Task</div>","options":{"root":"center","alignmentRails":false}},
          "transaction":{"type":"Text","style":{left:26,top:36,width:100,height:30},"html":"<span>Transaction</span>","options":{"root":"center","alignmentRails":false}}
          ,
          "object":{"type":"Text","style":{left:40,top:20,width:100,height:30},"html":"<span>Object</span>","options":{"root":"center","alignmentRails":false}},
          "laneTitle":{"type":"Text","style":{left:0,top:0,width:"100%",height:30},"html":"<div >Title</div>","options":{"root":"center","alignmentRails":false}},
          "flowDataC":{"frame":{"width":90,"height":59,"unit":"px"},"param":{"alignmentRails":true},"componentParms":[flowData]},
          "flowDB":{"frame":{"width":60,"height":60,"unit":"px"},"param":{"alignmentRails":true},"componentParms":[flowDB1,flowDB2],properties:["background-color"]},
          "flowDecision": {"frame":{"width":100,"height":100,"unit":"px"},"param":{"alignmentRails":true},"componentParms":[flowDecision1]},
          "flowDoc": {"frame":{"width":100,"height":70,"unit":"px"},"param":{"alignmentRails":true},"componentParms":[flowDoc1]},
          "flowManual":{"frame":{"width":100,"height":60,"unit":"px"},"param":{"alignmentRails":true},"componentParms":[flowManual1]},
          "flowIstorage":{"frame":{"width":70,"height":70,"unit":"px"},"param":{"alignmentRails":true},"componentParms":[flowIstorage0,flowIstorage1,flowIstorage2]},
          "flowSeqData":{"frame":{"width":100,"height":100,"unit":"px"},"param":{"alignmentRails":true},"componentParms":[flowSeqData0,flowSeqData1]},
          "flowPreDef":{"frame":{"width":100,"height":60,"unit":"px"},"param":{"alignmentRails":true},"componentParms":[flowPreDef0,flowPreDef1,flowPreDef2]},
          "flowStored":{"frame":{"width":100,"height":60,"unit":"px"},"param":{"alignmentRails":true},"componentParms":[flowStored0]},
          "flowStart":{"frame":{"width":100,"height":60,"unit":"px"},"param":{"alignmentRails":true},"componentParms":[flowStart0]},
          "laneV":{"frame":{"width":182,"height":461,"unit":"px"},"param":{"alignmentRails":true},"componentParms":[laneV1,laneV2,laneV3]},
          "ie":{"frame":{"width":60,"height":57,"unit":"px"},"param":{"alignmentRails":true},"componentParms":[ie1]},
          "server":{"frame":{"width":102,"height":74,"unit":"px"},"param":{"alignmentRails":true},"componentParms":[server1]},
          "firewall":{"frame":{"width":92,"height":83,"unit":"px"},"param":{"alignmentRails":true},"componentParms":[firewall1]},
          "umlFrame":{"frame":{"width":300,"height":200,"unit":"px"},"param":{"alignmentRails":true},"componentParms":[umlFrame0,umlFrame1]},
          "umlLifeLine":{"frame":{"width":100,"height":300,"unit":"px"},"param":{"alignmentRails":true},"componentParms":[umlLifeLine0,obj1,umlLifeLine1]},
          "umlActivity":{"frame":{"width":10,"height":80,"unit":"px"},"param":{"alignmentRails":true},"componentParms":[umlActivity0]},
          "umlClass":{"frame":{"width":160,"height":90,"unit":"px"},"param":{"alignmentRails":true},"componentParms":[umlClass0,umlClass1,umlClassText,umlFieldText,umlClass2,umlMethodText]},
          umlPackage:{"frame":{"width":70,"height":50,"unit":"px"},"param":{"alignmentRails":true},"componentParms":[umlPackage0,umlPackage1]},
          mText:{"frame":{"width":70,"height":20,"unit":"px"},"param":{"alignmentRails":true},"componentParms":[txt]}
   }
   
   
   activateSheetCalled = false;
   function activateSheet(_sheetName)
   {
       if (activateSheetCalled) return;
       activateSheetCalled = true;
       if (!_sheetName) _sheetName = event.target.getAttribute("id");
       setTimeout(function() {activateSheetCalled = false;},400 );
       var currentSheetName = MagicBoard.sheetBook.currentSheet.name;
       if (currentSheetName === _sheetName) return;
       // toggle "active" class for sheet tab & accordion tab
      $("#"+currentSheetName+"Tab").removeClass("active");
       
       var id = _sheetName;
       if (!_sheetName)
       {
           var target = event.target;
           id = target.getAttribute("id");
           
           // if no sheet name is provided, then it is click on the sheet tab itself else accordion click
           $("#"+id+"Ref").click();
       }


       
       var options = {"name":id};
       var sheet = MagicBoard.sheetBook.getSheet(id);
       if (!sheet)
       {
           sheet = new Sheet(options);
           MagicBoard.sheetBook.addSheet(sheet);
       }
       
        MagicBoard.sheetBook.setCurrentSheet(sheet);
        //sheet.reDraw();
        sheet.refreshConnections();
        $("#"+id+"Tab").addClass("active");
        // toggle active class for sheet tab and accordion tab
   }
   
   function promptSheetName()
   {
       $("#sheetNamePrompt").show();
       $("#sheetName").focus();
   }
   
   function addNewSheet()
   {
       var name = $("#sheetName").val();
       console.log(name);
       $("#sheetNamePrompt").hide();
       //
       var currentSheetName = MagicBoard.sheetBook.currentSheet.name;

       // toggle "active" class for sheet tab & accordion tab
       $("#"+currentSheetName+"Tab").removeClass("active");
       
       var options = {"name":name};
       var sheet = MagicBoard.sheetBook.getSheet(name);
       if (!sheet)
       {
           sheet = new Sheet(options);
           MagicBoard.sheetBook.addSheet(sheet);
       }
       
       MagicBoard.sheetBook.setCurrentSheet(sheet);
       
       var newHTML = "<li  onclick=\"activateSheet('"+name+"')\" id=\""+name+"Tab\" class=\"active\"><a  href=\"#\" id=\""+name+"\" class=\"dropdown-toggle\" data-toggle=\"dropdown\">"+name+"<span class=\"caret\"></span></button>" +
       "<ul class=\"dropdown-menu\">" +
       "<li><a href=\"#\" onclick=\"downloadSheetImage()\">Download</a></li>" +
       "<li><a href=\"#\" onclick=\"saveSheet()\">Save</a></li>" +
       "<li><a href=\"#\" onclick=\"deleteSheet()\">Delete</a></li>" +
       "</ul></a> </li>" ;
       /*
        <li  onclick="activateSheet('UML')" id="UMLTab" class="active"><a  href="#" id="UML" class="dropdown-toggle" data-toggle="dropdown">UML<span class="caret"></span></button>
        <ul class="dropdown-menu">
        <li><a href="#" onclick="downloadSheetImage()">Download</a></li>
        <li><a href="#" onclick="saveSheet()">Save</a></li>
        <li><a href="#" onclick="deleteSheet()">Delete</a></li>
        </ul></a> </li>
        */
       //$("#newTab");
       
       //$("#sheetTabs").before(newHTML);
       $("#NewTab").before(newHTML);

       //$("#"+name+"Tab").addClass("active");

   }
   
   function deleteSheet()
   {
       alert("Sheet - "+MagicBoard.sheetBook.currentSheet.name+" Deleted ");
   }
   
   function saveSheet()
   {
       var saved = MagicBoard.sheetBook.currentSheet.save();

       var a = document.createElement("a");
       a.setAttribute("download",MagicBoard.sheetBook.currentSheet.name+".json");
       a.href = "data:application/json,"+JSON.stringify(saved);
       a.click();
       alert("Sheet - "+MagicBoard.sheetBook.currentSheet.name+" saved ");
   }
   
   
  </script>
  </head>
  <body>
      <section class="container-fluid">
          <nav class="navbar navbar-custom" >
              <div class="container-fluid">
                  <div class="navbar-header">
                      <a class="navbar-brand" href="#">Magic Board</a>
                  </div>
                  <div>
                      <ul class="nav navbar-nav">
                          <li><a href="#" class="dropdown-toggle" data-toggle="dropdown">Documents<span class="caret"></span>
                              <ul class="dropdown-menu" id="documentMenu">
                                  <li><a href="#">BRD</a></li>
                                  <li><a href="#">HLD</a></li>
                                  <li><a href="#">LLD</a></li>
                              </ul></a></li>
                          <li><a href="#">Login</a></li>
                      </ul>
                  </div>
              </div>
          </nav>
          <div class="row">
              <section class="col-sm-2 vertBox" style="border-right:1px dotted #229922">
                  <!-- menu starts here -->
                    <ul class="nav nav-tabs" id="sectionMenu">
                        <!--
                        <li class="active"><a data-toggle="tab" href="#drawing">Drawing</a></li>
                        <li><a data-toggle="tab" href="#enterprise">Assets</a></li>
                        -->
                    </ul>
                  <!-- menu ends -->
                  <div class="tab-content">

                  </div> <!-- tab-content -->
              </section>
                <!-- sheets go in here -->
              <div class="col-sm-10 vertBox">
                  <!-- tab menu for sheets -->
                  <ul class="nav nav-tabs" id="sheetTabs">
                      <li  onclick="activateSheet('Sheet1')" id="Sheet1Tab" class="active"><a  href="#" id="Sheet1" class="dropdown-toggle" data-toggle="dropdown">Sheet1<span class="caret"></span>
                          <ul class="dropdown-menu" id="sheetMenu">
                              <li><a href="#" onclick="downloadSheetImage()">Download</a></li>
                              <li><a href="#" onclick="saveSheet()">Rename</a></li>
                              <li><a href="#" onclick="saveSheet()">Save</a></li>
                              <li><a href="#" onclick="deleteSheet()">Delete</a></li>
                          </ul></a> </li>
                      <li  onclick="promptSheetName()" id="NewTab" ><a  href="#" id="new">New Sheet</a></li>
                      <!--
                      <li onclick="activateSheet()"><a href="#layer">Entity Relation</a></li>
                      <li onclick="hilight()"><a href="#layer">BPM</a></li>
                      <li onclick="hilight()"><a href="#layer">Wireframes</a></li>
                      -->
                  </ul>
                  <!--  tab menu ends -->
                  <section id="paper" draggable="false" ondrop="drop(event)" ondragover="allowDrop(event)" style="position:absolute;height:800px;width:1300px;">
                  </section>
              </div>
              <!--  sheets end here --->
          </div>
      </section>
      
      // sheet prompt
      <div style="position:absolute;left:35%;top:35%;width:300px;height:150px;border:1px solid grey;box-shadow:5px 5px gray;padding:30px;z-index:100;display:none;background:white" id="sheetNamePrompt">
          <section class="row">
              <div class="form-group">
                  <label for="sheetName">Sheet Name:</label>
                  <input type="text" class="form-control" id="sheetName">
                      <br>
                  <button type="button" class="btn btn-success" onclick="addNewSheet()">Add</button>
                  <button type="button" class="btn btn-warning" onclick="$('#sheetNamePrompt').hide();">Cancel</button>
              </div>
          </section>
      </div>
      // sheet prompt ends
      // background change
      <div style="position:absolute;left:35%;top:35%;width:300px;height:auto;border:1px solid grey;box-shadow:5px 5px gray;padding:30px;z-index:100;display:none;background:white;color:rgb(27,141,17)" id="stylePrompt">
          
              <div class="form-group">
                  <section class="row" style="height:40px">
                      <section class="col-sm-8"><label for="backgroundColor">Background Color:</label></section>
                      <section class="col-sm-4"><input type="color" class="form-control" id="backgroundColor" value="#1b8d11"></section>
                  </section>
                  <section class="row" style="height:40px">
                      <section class="col-sm-8"><label for="opacity">Opacity:</label></section>
                      <section class="col-sm-4"><input type="text" class="form-control" id="opacity" value="1.0"></section>
                  </section>

                  <section class="row" style="height:40px">
                      <section class="col-sm-8"><label for="stroke">Line Size:</label></section>
                      <section class="col-sm-4"><input type="text" class="form-control" id="stroke" value="1"></section>
                  </section>
                  <section class="row" style="height:40px">
                      <section class="col-sm-8"><label for="strokeColor">Line Color:</label></section>
                      <section class="col-sm-4"><input type="color" class="form-control" id="strokeColor" value="#1b8d11"></section>
                  </section>

                  <section class="row">
                      <button type="button" class="btn btn-success" onclick="addNewSheet()">Apply</button>
                      <button type="button" class="btn btn-warning" onclick="$('#stylePrompt').hide();">Cancel</button>
                 </section>
            </div>
          
      </div>
      
  </body>
  <script src="js/jquery.js"></script>
  <!-- Latest compiled and minified JavaScript -->
  <script src="js/bootstrap.js"></script>

  
  <script>
      /*
      // sample
      var r = new ShapeComponent({type:"rect",dimension:{width:100,height:100,x:0,y:0},param:{"fill":"none","stroke-width":1,"stroke":"black"}});
      var c = new ShapeComponent({type:"circle",dimension:{cx:50,cy:50,r:50},param:{"fill":"none","stroke-width":1,"stroke":"black"}});
      var o = new ShapeComponent({type:"ellipse",dimension:{cx:50,cy:50,rx:40,ry:20},param:{"fill":"none","stroke-width":1,"stroke":"black"}});
      var p = new ShapeComponent({type:"path",dimension:{d:[{op:"m",x:0,y:40},{op:"l",x:30,y:40},{op:"m",x:10,y:40},{op:"l",x:30,y:40}]},param:{"fill":"none","stroke-width":1,"stroke":"black"}});
      var t = new ShapeComponent({type:"text",dimension:{width:100,height:10,x:20,cy:50},param:{"font-size":14},"innerHTML":"Object"});
                var i = {type:"image",dimension:{width:10,height:10,cx:70,cy:50},param:{"src":"image/uml1.png"}};
       var s =
                                {
                                frame:{width:100,height:100,left:130,top:140,unit:"px"},
                                param:{alignmentRails:true,"background-color":"lightblue","border-width":1,"border-color":"black"},
                                components:[r,c,o,t,p]
                                }
  */
  
  function buildSideMenu()
  {
      var dLen = data.length;
      var sectionMenu =  $("#sectionMenu");
      var tabContent = $(".tab-content");
      var lis = ""; var clsTab = "active"; var clsAccordion = "active"; var clsTV = "";var clsAV = "";
      var tabSection = "";
      for (var i = 0; i < dLen;i++)
      {
          var section = data[i].section;
          if (clsTab) clsTV = " class='"+clsTab+"'";
          else clsTV = "";
          lis += "<li "+clsTV+"><a data-toggle=\"tab\" href=\"#"+section.id+"\">"+section.title+"</a></li>";
          clsAV = " class='tab-pane fade ";
          if (clsAccordion) clsAV = clsAV+" in "+clsAccordion+"'";
          else clsAV = clsAV+"'";
          tabSection += "<div "+clsAV+" id='"+section.id+"'><div class='panel-group' id='"+section.id+"Accordion' style='margin-top:10px;'>";
          var cLen = section.categories.length;
          for (var c = 0; c < cLen;c++)
          {
              var category = section.categories[c];
              tabSection += "<section class='panel panel-default'><div class='panel-heading'>";
              // onclick="activateSheet('Layer')" <-- to be done later
              tabSection += "<h4 class='panel-title'><a data-toggle=\"collapse\"  id='"+category.id+"Ref' data-parent='#"+section.id+"Accordion' href='#"+category.id+"List'>"+category.title+"</a></h4>";
              tabSection += "</div><div class='panel-collapse collapse' id='"+category.id+"List'><div class='panel-body'>";
              // build the list now
              var lists = category.list; var lLen = lists.length;
              for (var l = 0; l < lLen;l++)
              {
                  var list = lists[l];
                  tabSection += "<div class='' id='"+list.id+"Div' style='width:50px;height:50px;float:left' data-toggle='tooltip'  title='"+list.description+"'>";
                  tabSection += "<div style='font-size:7px;text-align:center'>"+list.description+"</div><img src='"+list.icon+"' id='"+list.id+"' draggable='true' ondragstart='drag(event)' onclick=\"addObject('"+list.id+"')\" class=\"imgIcon\">";
                  tabSection += "</div>";
              }
              tabSection += "</div></div></section>";
          }
          tabSection +="</div></div>";
          clsAccordion = "";
          clsTab = ""; // only first element is active, we can remove class afterwards
          
      }
      
      tabContent.html(tabSection);
        sectionMenu.html(lis);
        
        // initialize tool tip
        $("[data-toggle='tooltip']").tooltip();
  }
  
  
  // JSON
  var data =
[
   {"section":{title:"Drawing","id":"drawing",
   categories:[
               {title:"Layer Diagram",id:"Layer",
               list:[
                     {"id":"layers","icon":"image/layers.png","description":"Layer"},
                     {"id":"process","icon":"image/process.png","description":"Process"}
                     ]
               },
               {title:"UML Diagram",id:"Uml",
               list:[
                     {"id":"umlObject","icon":"image/umlObject.png","description":"Object"},
                     {"id":"umlClass","icon":"image/umlClass.png","description":"Class"},
                     {"id":"uml12","icon":"image/umlActor.png","description":"Actor"},
                     {"id":"uml13","icon":"image/umlUseCase.png","description":"UseCase"},
                     {"id":"umlFrame","icon":"image/umlFrame.png","description":"Frame"},
                     {"id":"umlLifeLine","icon":"image/umlLifeLine.png","description":"Life Line"},
                     {"id":"umlActivity","icon":"image/umlActivity.png","description":"Activity"},
                     {"id":"umlPackage","icon":"image/umlPackage.png","description":"Package"},
                     {"id":"mText","icon":"image/mText.png","description":"Text"}
                    ]
               },
               {title:"Flow Chart",id:"Flow",
               list:[
                     {"id":"flowDataC","icon":"image/flowData.png","description":"Data"},
                     {"id":"flowDB","icon":"image/flowDB.png","description":"Database"},
                     {"id":"flowDecision","icon":"image/flowDecision.png","description":"Decision"},
                     {"id":"process","icon":"image/process.png","description":"Process"},
                     {"id":"flowDoc","icon":"image/flowDoc.png","description":"Document"},
                     {"id":"flowManual","icon":"image/flowManual.png","description":"Manual Input"},
                     {"id":"flowIstorage","icon":"image/flowIstorage.png","description":"Internal Storage"},
                     {"id":"flowSeqData","icon":"image/flowSeqData.png","description":"Sequential Data"},
                     {"id":"flowPreDef","icon":"image/flowPreDef.png","description":"Pre Defined Process"},
                     {"id":"flowStored","icon":"image/flowStored.png","description":"Stored Data"},
                     {"id":"flowStart","icon":"image/flowStart.png","description":"Start/End"}
                     ]
               },
               {title:"Deployment Diagram",id:"Deployment",
               list:[
                     {"id":"laneV","icon":"image/uml1.png","description":"Vertical Lane"},
                     {"id":"ie","icon":"image/ie.png","description":"Browser"},
                     {"id":"server","icon":"image/server.png","description":"Server"},
                     {"id":"firewall","icon":"image/firewall.png","description":"Firewall"}
                     ]
               }
               
            ]
        }
   },
   {"section":{title:"Assets",id:"enterprise",
   categories:[
               {title:"Services",id:"Service",
               list:[
                     {"id":"Customers","icon":"image/service.png","description":"Customers"},
                     {"id":"Account","icon":"image/service.png","description":"Account"}
                     ]
               },
               {title:"Programs",id:"Program",
               list:[
                     {"id":"PGMLST1","icon":"image/program1.png","description":"Customer.java"},
                     {"id":"PGMLST2","icon":"image/program2.png","description":"Account.net"}
                     ]
               },
               {title:"Doc Template",id:"DocTemplate",
               list:[
                     {"id":"BRD","icon":"image/doc.png","description":"BRD Usecase"},
                     {"id":"HLD","icon":"image/doc.png","description":"HLD"}
                     ]
               }
               
            ]
        }
   }
]
   
   //
   
      $( document ).ready(function() {
                          buildSideMenu();

                          var paper = document.getElementById("paper");
                          var pDim = paper.getBoundingClientRect();
                          MagicBoard.sheetBook = new SheetBook(paper,pDim.width,pDim.height);
                          //MagicBoard.sheetBook = new SheetBook(paper,440,500);
                          var sheet1 = new Sheet({name:defaultSheet});
                          MagicBoard.sheetBook.addSheet(sheet1);
                          MagicBoard.sheetBook.setCurrentSheet(sheet1);

                          //
                          //var shape = new Shape(s);
                          //shape.draw();
                          //shape.addHover();
                          //shape.setPosition({"x":10,"y":400});
                          /*
                          var style1 = {left:100,top:100,width:50,height:50,"background-color":"#ff0000","border-width":3,"border-color":"rgb(27,141,17)","border-radius":150};
                          
                          var r1 = new Rect(style1);
                          r1.draw();
                          r1.addHover();
                          */
                          
                          });
                          
                          
        function tempDraw()
        {
            var s0 = addObject("umlClass",false,{x:23,y:138});
            var s1 = addObject("umlClass",false,{x:345,y:138});
            var s2 = addObject("umlClass",false,{x:345,y:332});
            var s3 = addObject("umlClass",false,{x:740,y:23});
            var s4 = addObject("umlClass",false,{x:740,y:332});
            
            s1.connectTo(s0);
            s1.connectTo(s2);
            s1.connectTo(s3);
            s1.connectTo(s4);
            
            s0.updateText("User",0);s0.updateText("+firstName:String",1);s0.updateText("+addUser():bool",2);
            s1.updateText("Booking",0);s1.updateText("+bookingRef:bool",1);s1.updateText("+addBooking():bool",2);
            s2.updateText("Ticket",0);s2.updateText("+ticketName:String",1);s2.updateText("+addTicket():bool",2);
            s3.updateText("Payment",0);s3.updateText("+invoiceNo:int",1);s3.updateText("+addPayment():bool",2);
            s4.updateText("Show",0);s4.updateText("+showName:String",1);s4.updateText("+addShow():bool",2);
        }
      </script>
</html>


